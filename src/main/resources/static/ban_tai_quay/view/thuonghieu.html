<div ng-controller="thuongHieuCtrl" class="container-fluid mt-4 px-4">

    <div class="card border-0 shadow-sm rounded-4">

        <!-- ================= HEADER ================= -->
        <div class="card-header bg-white border-0 d-flex justify-content-between align-items-center py-3 px-4">
            <div>
                <h4 class="mb-0 fw-bold text-primary">
                    <i class="fa-solid fa-tags me-2"></i> Quản lý thương hiệu
                </h4>
                <small class="text-muted">Quản lý danh sách thương hiệu sản phẩm</small>
            </div>

            <button class="btn btn-success px-4" ng-click="moModalThem()">
                <i class="fa fa-plus me-1"></i> Thêm thương hiệu
            </button>
        </div>

        <!-- ================= FILTER ================= -->
        <div class="card-body border-bottom px-4">
            <div class="row g-3 align-items-center">

                <!-- SEARCH -->
                <div class="col-lg-5">
                    <div class="input-group shadow-sm">
                        <span class="input-group-text bg-light">
                            <i class="fa fa-search"></i>
                        </span>
                        <input type="text"
                               class="form-control"
                               placeholder="Tìm theo tên thương hiệu..."
                               ng-model="search.tenTH"
                               ng-change="timKiem()">
                    </div>
                </div>

                <!-- STATUS -->
                <div class="col-lg-3">
                    <select class="form-select shadow-sm"
                            ng-model="search.trangThai"
                            ng-change="timKiem()">
                        <option ng-value="null">-- Tất cả trạng thái --</option>
                        <option ng-value="1">Hoạt động</option>
                        <option ng-value="0">Ngừng</option>
                    </select>
                </div>

                <!-- RESET -->
                <div class="col-lg-2">
                    <button class="btn btn-outline-secondary w-100 shadow-sm"
                            ng-click="reset()">
                        <i class="fa fa-rotate me-1"></i> Reset
                    </button>
                </div>

            </div>
        </div>
        <pre>{{ dsThuongHieu.length }}</pre>
        <!-- ================= TABLE ================= -->
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">

                <thead class="table-light text-center">
                <tr>
                    <th width="60">STT</th>
                    <th width="140">Mã</th>
                    <th class="text-start">Tên thương hiệu</th>
                    <th width="140">Trạng thái</th>
                    <th class="text-start">Mô tả</th>
                    <th width="160">Hành động</th>
                </tr>
                </thead>

                <tbody>
                <tr ng-repeat="th in dsThuongHieu track by th.maTH">
                    <td class="text-center">{{$index + 1}}</td>
                    <td class="fw-semibold text-primary">{{th.maTH}}</td>
                    <td class="fw-medium">{{th.tenTH}}</td>

                    <td class="text-center">
                        <span class="badge bg-success" ng-if="th.trangThai === 1">Hoạt động</span>
                        <span class="badge bg-secondary" ng-if="th.trangThai === 0">Ngừng</span>
                    </td>

                    <td class="text-muted">{{th.moTa || '—'}}</td>

                    <!-- ACTION -->
                    <td class="text-center">
                        <!-- XEM CHI TIẾT -->
                        <button class="btn btn-outline-info btn-sm me-1"
                                title="Xem chi tiết"
                                ng-click="xemChiTiet(th.id)">
                            <i class="fa fa-eye"></i>
                        </button>

                        <!-- CHỈNH SỬA -->
                        <button class="btn btn-outline-warning btn-sm me-1"
                                title="Chỉnh sửa"
                                ng-click="moModalSua(th.id)">
                            <i class="fa fa-pen"></i>
                        </button>

                        <!-- XÓA -->
                        <button class="btn btn-outline-danger btn-sm"
                                title="Xóa"
                                ng-click="xoaThuongHieu(th)">
                            <i class="fa fa-trash"></i>
                        </button>
                    </td>

                </tr>

                <tr ng-if="dsThuongHieu.length === 0">
                    <td colspan="6" class="text-center text-muted py-5">
                        Không có dữ liệu
                    </td>
                </tr>
                </tbody>

            </table>
        </div>

    </div>


    <div class="modal fade" id="modalThemThuongHieu" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow rounded-4">
                <form ng-submit="luuThuongHieu()" novalidate>
                    <!-- HEADER -->
                    <div class="modal-header bg-success text-white px-4">
                        <h5 class="modal-title fw-bold">
                            {{ isView ? 'Chi tiết thương hiệu'
                            : (isEdit ? 'Cập nhật thương hiệu' : 'Thêm thương hiệu') }}
                        </h5>
                        <button type="button"
                                class="btn-close btn-close-white"
                                data-bs-dismiss="modal"></button>
                    </div>

                    <!-- BODY -->
                    <div class="modal-body px-4 pt-4">
                        <div class="alert alert-danger small py-2" ng-if="loi">
                            <i class="fa fa-circle-exclamation me-2"></i> {{loi}}
                        </div>
                        <!-- TÊN -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">
                                Tên thương hiệu <span class="text-danger">*</span>
                            </label>
                            <input type="text"
                                   class="form-control"
                                   placeholder="VD: Nike, Adidas, Puma..."
                                   ng-model="thuongHieuMoi.tenTH"
                                   ng-disabled="isView"
                                   ng-class="{'is-invalid': loi.tenTH}">
                            <div class="invalid-feedback">{{loi.tenTH}}</div>
                        </div>

                        <!-- TRẠNG THÁI -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">
                                Trạng thái <span class="text-danger">*</span>
                            </label>
                            <select class="form-select ng-pristine ng-untouched ng-valid"
                                    ng-model="thuongHieuMoi.trangThai"
                                    ng-disabled="isView"
                                    ng-init="thuongHieuMoi.trangThai = thuongHieuMoi.trangThai || ''"
                                    ng-class="{'is-invalid': loi.trangThai}">
                                <option value="">--Chọn trạng thái--</option>
                                <option value="1">Hoạt Động</option>
                                <option value="0">Ngừng</option>
                            </select>
                            <div class="invalid-feedback">{{loi.trangThai}}</div>
                        </div>

                        <!-- MÔ TẢ -->
                        <div>
                            <label class="form-label fw-semibold">Mô tả</label>
                            <textarea class="form-control"
                                      rows="3"
                                      placeholder="Nhập mô tả ngắn về thương hiệu (không bắt buộc)"
                                      ng-model="thuongHieuMoi.moTa"
                                      ng-disabled="isView"></textarea>
                        </div>

                    </div>

                    <!-- FOOTER -->
                    <div class="modal-footer border-0 px-4 pb-4">
                        <button type="button" class="btn btn-light" data-bs-dismiss="modal">
                            Đóng
                        </button>

                        <button type="submit"
                                class="btn btn-success px-4"
                                ng-if="!isView"
                                ng-disabled="dangGui">
                            <i class="fa fa-save me-1"></i> Lưu
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <!-- ================= MODAL XEM CHI TIẾT ================= -->
    <div class="modal fade" id="modalXemChiTiet" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow rounded-4">

                <div class="modal-header bg-info text-white px-4">
                    <h5 class="modal-title fw-bold">Chi tiết thương hiệu</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body px-4 pt-4">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">ID</label>
                            <input type="text" class="form-control" ng-model="thuongHieuView.id" disabled>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Mã thương hiệu</label>
                            <input type="text" class="form-control" ng-model="thuongHieuView.maTH" disabled>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Tên thương hiệu</label>
                            <input type="text" class="form-control" ng-model="thuongHieuView.tenTH" disabled>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Trạng thái</label>
                            <input type="text" class="form-control"
                                   ng-value="thuongHieuView.trangThai === 1 ? 'Hoạt động' : 'Ngừng'" disabled>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Ngày tạo</label>
                            <input type="text" class="form-control" ng-model="thuongHieuView.ngayTao" disabled>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Ngày sửa</label>
                            <input type="text" class="form-control" ng-model="thuongHieuView.ngaySua" disabled>
                        </div>
                        <div class="col-12">
                            <label class="form-label fw-semibold">Mô tả</label>
                            <textarea class="form-control" rows="3" ng-model="thuongHieuView.moTa" disabled></textarea>
                        </div>
                    </div>
                </div>

                <div class="modal-footer border-0 px-4 pb-4">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Đóng</button>
                </div>

            </div>
        </div>
    </div>



    <!-- ================= MODAL CHỈNH SỬA ================= -->
    <div class="modal fade" id="modalChinhSua" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow rounded-4">
                <div class="alert alert-danger small py-2" ng-if="loi">
                    <i class="fa fa-circle-exclamation me-2"></i> {{loi}}
                </div>
                <form ng-submit="luuThuongHieu()" novalidate>

                    <div class="modal-header bg-warning text-white px-4">
                        <h5 class="modal-title fw-bold">Cập nhật thương hiệu</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body px-4 pt-4">

                        <div class="mb-3">
                            <label class="form-label fw-semibold">Mã thương hiệu</label>
                            <input type="text" class="form-control" ng-model="thuongHieuMoi.maTH" disabled>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-semibold">Tên thương hiệu <span class="text-danger">*</span></label>
                            <input type="text" class="form-control"
                                   placeholder="VD: Nike, Adidas, Puma..."
                                   ng-model="thuongHieuMoi.tenTH"
                                   ng-class="{'is-invalid': loi.tenTH}">
                            <div class="invalid-feedback">{{loi.tenTH}}</div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-semibold">Trạng thái <span class="text-danger">*</span></label>
                            <select class="form-select"
                                    ng-model="thuongHieuMoi.trangThai"
                                    ng-class="{'is-invalid': loi.trangThai}">
                                <option value="" disabled>-- chọn trạng thái --</option>
                                <option ng-value="1">Hoạt động</option>
                                <option ng-value="0">Ngừng</option>
                            </select>
                            <div class="invalid-feedback">{{loi.trangThai}}</div>
                        </div>

                        <div>
                            <label class="form-label fw-semibold">Mô tả</label>
                            <textarea class="form-control" rows="3"
                                      placeholder="Nhập mô tả ngắn về thương hiệu (không bắt buộc)"
                                      ng-model="thuongHieuMoi.moTa"></textarea>
                        </div>

                    </div>

                    <div class="modal-footer border-0 px-4 pb-4">
                        <button type="button" class="btn btn-light" data-bs-dismiss="modal">Đóng</button>
                        <button type="submit" class="btn btn-warning px-4" ng-disabled="dangGui">
                            <i class="fa fa-save me-1"></i> Lưu
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<!-- ================= MODAL THÊM ================= -->


