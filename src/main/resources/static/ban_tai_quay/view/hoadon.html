
<div ng-controller="hoaDonCtrl">

    <h2 class="mb-3">Quản lý Hóa Đơn</h2>

    <table class="table table-bordered table-hover">
        <thead class="table-dark">
        <tr>
            <th>STT</th>
            <th>ID</th>
            <th>Mã</th>
            <th>Nhân viên</th>
            <th>Khác hàng</th>
            <th>Ngày đặt</th>
            <th>Hóa Đơn</th>
            <th>Thanh toán</th>
            <th>Địa chỉ</th>
            <th>Trạng thái</th>
            <th>Hành Động</th>
        </tr>
        </thead>

        <tbody>
        <tr ng-repeat="hd in dsHoaDon">
            <td>{{$index + 1}}</td>
            <td>{{hd.id}}</td>
            <td>{{hd.ma}}</td>
            <td>{{hd.tenNV}}</td>
            <td>{{hd.tenKH}}</td>
            <td>{{hd.ngayDatHang | date:'dd/MM/yyyy HH:mm'}}</td>

            <td>
                <span ng-if="hd.loaiHoaDon == 1" class="badge bg-success">Online</span>
                <span ng-if="hd.loaiHoaDon == 0" class="badge bg-secondary">Tại quầy</span>
            </td>

            <td>{{hd.phuongThucThanhToan}}</td>
            <td>{{hd.diaChi}}</td>

            <td>
                <span ng-if="hd.trangThai == 0" class="badge bg-warning">Chờ TT</span>
                <span ng-if="hd.trangThai == 1" class="badge bg-success">Đã TT</span>
            </td>
            <td class="text-center">
                <button class="btn btn-info btn-sm" ng-click="openHoaDonDetail(hd.id)">
                    Chi tiết
                </button>


            </td>
        </tr>
        </tbody>
    </table>


    <div class="modal fade" id="hoaDonDetailModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">

                <!-- HEADER -->
                <div class="modal-header">
                    <h4 class="modal-title">Chi Tiết Đơn Hàng</h4>
                    <button class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">

                    <!-- TIMELINE -->
                    <div class="d-flex justify-content-between mb-4 text-center">
                        <div>
                            <i class="bi bi-check-circle text-primary fs-4"></i>
                            <div>Tạo đơn</div>
                        </div>
                        <div>
                            <i class="bi bi-check-circle text-primary fs-4"></i>
                            <div>Xác nhận</div>
                        </div>
                        <div>
                            <i class="bi bi-truck text-success fs-4"></i>
                            <div>Giao hàng</div>
                        </div>
                        <div>
                            <i class="bi bi-check-circle-fill text-success fs-4"></i>
                            <div>Hoàn thành</div>
                        </div>
                    </div>

                    <!-- THÔNG TIN ĐƠN HÀNG -->
                    <h5>Thông Tin Đơn Hàng</h5>
                    <div class="row mb-3">
                        <p>Trạng thái: <b>{{hoaDonDangXem.trangThai}}</b></p>
                        <p>Mã đơn: {{hoaDonDangXem.ma}}</p>
                        <p>Loại đơn: {{hoaDonDangXem.loaiHoaDon == 1 ? 'Online' : 'Tại quầy'}}</p>

                        <p>Phí VC: {{hoaDonDangXem.phiVanChuyen | number}} đ</p>
                        <p>Tổng tiền: {{hoaDonDangXem.tongTien | number}} đ</p>
                        <p>Tiền được giảm: {{hoaDonDangXem.giamGia | number}} đ</p>
                        <p>Phải thanh toán: {{hoaDonDangXem.thanhTien | number}} đ</p>

                    </div>

                    <!-- KHÁCH HÀNG -->
                    <h5>Thông Tin Khách Hàng</h5>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <p>Tên KH: {{hoaDonDangXem.khachHang.ten}}</p>
                            <p>SĐT: {{hoaDonDangXem.khachHang.sdt}}</p>
                        </div>
                        <div class="col-md-6">
                            <p>Email: {{hoaDonDangXem.khachHang.email}}</p>
                            <p>Địa chỉ: {{hoaDonDangXem.diaChi}}</p>
                        </div>
                    </div>

                    <!-- BẢNG CHI TIẾT SP -->
                    <h5>Chi Tiết Sản Phẩm</h5>

                    <div ng-repeat="ct in dsHDCT" class="border rounded p-3 mb-3">
                        <div class="row">
                            <div class="col-md-6">
                                <p><b>Sản phẩm:</b> {{ct.tenSanPham}}</p>
                                <p><b>Size:</b> {{ct.tenSize}}</p>
                                <p><b>Màu:</b> {{ct.tenMau}}</p>
                                <p><b>Thể loại:</b> {{ct.tenTL}}</p>
                            </div>

                            <div class="col-md-6">
                                <p><b>Chất liệu:</b> {{ct.tenCL}}</p>
                                <p><b>Thương hiệu:</b> {{ct.tenTH}}</p>
                                <p><b>Giá:</b> {{ct.giaBan | number}} đ</p>
                                <p><b>Số lượng:</b> {{ct.soLuong}}</p>
                                <p>
                                    <b>Thành tiền:</b>
                                    {{ct.giaBan * ct.soLuong | number}} đ
                                </p>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">
                        Đóng
                    </button>
                </div>

            </div>
        </div>
    </div>



</div>


